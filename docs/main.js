(()=>{var e,t={},n=t&&t.__extends||(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Types=t.Model=void 0;var r={};Object.defineProperty(r,"__esModule",{value:!0}),r.Types=r.Model=void 0;var o={},i=o&&o.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=o&&o.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,c)}s((r=r.apply(e,t||[])).next())}))},c=o&&o.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(u=0)),u;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return u.label++,{value:c[1],done:!1};case 5:u.label++,r=c[1],c=[0];continue;case 7:c=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){u=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){u.label=c[1];break}if(6===c[0]&&u.label<o[1]){u.label=o[1],o=c;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(c);break}o[2]&&u.ops.pop(),u.trys.pop();continue}c=t.call(e,u)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(o,"__esModule",{value:!0}),o.Model=void 0;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return i(t,e),t.__ns__=function(){var e;return null!==(e=this.__namespace__)&&void 0!==e?e:this.name},t.useStorage=function(e){this.__area__=e},t.__rawdict__=function(){return u(this,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return e=this.__ns__(),[4,this.__area__.get(e)];case 1:return[2,(t.sent()||{})[e]||{}]}}))}))},t.new=function(e,t){var n=new this(e);return n._id=null!=t?t:null,Object.entries(e||{}).map((function(e){var t=e[0],r=e[1];n[t]=r})),n},t.create=function(e){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.new(e).save()];case 1:return[2,t.sent()]}}))}))},t.list=function(){return u(this,void 0,void 0,(function(){var e,t=this;return c(this,(function(n){switch(n.label){case 0:return[4,this.__rawdict__()];case 1:return e=n.sent(),[2,Object.entries(e).map((function(e){var n=e[0],r=e[1];return t.new(r,n)}))]}}))}))},t.filter=function(e){return u(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.list()];case 1:return[2,t.sent().filter(e)]}}))}))},t.find=function(e){return u(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return[4,this.__rawdict__()];case 1:return[2,(t=n.sent())[e]?this.new(t[e],e):null]}}))}))},t.drop=function(){return u(this,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return[4,this.__area__.set((e={},e[this.__ns__()]={},e))];case 1:return t.sent(),[2]}}))}))},t.prototype.save=function(){return u(this,void 0,void 0,(function(){var e,t,n;return c(this,(function(r){switch(r.label){case 0:return[4,(e=this.constructor).__rawdict__()];case 1:return t=r.sent(),this._id||(this._id=e.__nextID__(t)),t[this._id]=this,[4,e.__area__.set((n={},n[e.__ns__()]=t,n))];case 2:return r.sent(),[2,this]}}))}))},t.prototype.delete=function(){return u(this,void 0,void 0,(function(){var e,t,n;return c(this,(function(r){switch(r.label){case 0:return[4,(e=this.constructor).__rawdict__()];case 1:return delete(t=r.sent())[this._id],[4,e.__area__.set((n={},n[e.__ns__()]=t,n))];case 2:return r.sent(),delete this._id,[2,this]}}))}))},t.__area__=null===(n=null===chrome||void 0===chrome?void 0:chrome.storage)||void 0===n?void 0:n.local,t}(function(){function e(){}var t;return e.timestampID=function(){return String(Date.now())},e.sequentialID=function(e){void 0===e&&(e={});var t=Object.keys(e).map((function(e){return parseInt(e,10)})).sort((function(e,t){return e<t?-1:1})).pop();return String((t||0)+1)},t=e,e.__nextID__=t.timestampID,e}());o.Model=s,Object.defineProperty(r,"Model",{enumerable:!0,get:function(){return o.Model}});var a={};Object.defineProperty(a,"__esModule",{value:!0}),a.Types=void 0;var l={};Object.defineProperty(l,"__esModule",{value:!0}),l.createPrimitiveTypeChecker=void 0,l.createPrimitiveTypeChecker=function(e,t){var n=function(n,r,o){if(void 0===r){if(n)throw new Error("".concat(o," is marked as required"));return null}if(!t(r))throw new Error("".concat(o," is not ").concat(e));return null},r=n.bind(null,!1);return r.isRequired=n.bind(null,!0),r};var f={};Object.defineProperty(f,"__esModule",{value:!0}),f.createDateTypeChecker=void 0,f.createDateTypeChecker=function(){var e=function(e,t,n){if(void 0===t){if(e)throw new Error("".concat(n," is marked as required, but got undefined"));return null}if("function"==typeof t.constructor&&"Date"===t.constructor.name)return null;throw new Error("".concat(n," is supposed to be Date, but got ").concat(t.constructor.name))},t=e.bind(null,!1);return t.isRequired=e.bind(null,!0),t.load=function(e){return new Date(e)},t};var _={};Object.defineProperty(_,"__esModule",{value:!0}),_.modelTypeChecker=void 0,_.modelTypeChecker=function(e,t){void 0===t&&(t={});var n=function(e,t,n){if(void 0===t){if(e)throw new Error("".concat(n," is marked as required"));return null}return null},r=n.bind(null,!1);return r.isRequired=n.bind(null,!0),r.ref=e,r.load=function(e){return t.eager?e&&void 0!==e._id?r.ref.find(e._id):void 0:new r.ref(e)},r},a.Types={bool:(0,l.createPrimitiveTypeChecker)("bool",(function(e){return"boolean"==typeof e})),number:(0,l.createPrimitiveTypeChecker)("number",(function(e){return"number"==typeof e})),string:(0,l.createPrimitiveTypeChecker)("string",(function(e){return"string"==typeof e})),object:(0,l.createPrimitiveTypeChecker)("object",(function(e){return"object"==typeof e})),array:(0,l.createPrimitiveTypeChecker)("array",(function(e){return Array.isArray(e)})),date:(0,f.createDateTypeChecker)(),model:_.modelTypeChecker},Object.defineProperty(r,"Types",{enumerable:!0,get:function(){return a.Types}});var d={};Object.defineProperty(d,"__esModule",{value:!0}),d.use=void 0,d.use=function(e){return function(e){function t(t,n){var r=[],o=null;0==arguments.length?r=Object.keys(e):t instanceof Function?o=t:t instanceof Array?r=t:t&&(r=[t]),n instanceof Function&&(o=n);var i=r.reduce((function(t,n){var r;return t+n.length+((null===(r=e.getItem(n))||void 0===r?void 0:r.length)||0)}),0);if(!o)return Promise.resolve(i);o(i)}function n(t){if(e.clear(),!t)return Promise.resolve();t()}function r(t,n){if(Object.entries(t).map((function(t){var n=t[0],r=t[1];return e.setItem(n,JSON.stringify(r))})),!n)return Promise.resolve();n()}function o(t,n){if((t instanceof Array?t:[t]).map((function(t){return e.removeItem(t)})),!n)return Promise.resolve();n()}function i(t,n){var r=[],o=null,i={};0==arguments.length?r=Object.keys(e):t instanceof Function?(r=Object.keys(e),o=t):"string"==typeof t?r=[t]:t instanceof Array?r=t:t instanceof Object&&(i=t,0==(r=Object.keys(t)).length&&(r=Object.keys(e))),n instanceof Function&&(o=n);var u=r.reduce((function(t,n){return t[n]=JSON.parse(e.getItem(n)||"null")||i[n]||null,t}),{});if(!o)return Promise.resolve(u);o(u)}function u(e,t){if(!t)return Promise.resolve();t()}function c(e,t){}function s(e,t){}function a(e,t){}var l=null;return{getBytesInUse:t,clear:n,set:r,remove:o,get:i,setAccessLevel:u,onChanged:{addListener:function(e){l=e},hasListener:function(e){return!!l&&l==e},hasListeners:function(){return!!l},removeListener:function(e){this.hasListener(e)&&(l=null)},getRules:c,addRules:s,removeRules:a}}}(e)};var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.__area__=d.use(globalThis.localStorage),t}(r.Model);t.Model=v,Object.defineProperty(t,"Types",{enumerable:!0,get:function(){return a.Types}});class p extends t.Model{static __namespace__="Item"}(async()=>{console.log(await p.list());const e=await p.create({title:"test",status:0});console.log(e),console.log(await p.list())})()})();